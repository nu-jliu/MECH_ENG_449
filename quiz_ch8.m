% ME449
% Allen Liu
% Quiz 8

close all
clear variables
clc

rho = 5.6e3;
R   = 20e-2/2;
d   = 4e-2;
L   = 20e-2;

%% Cylinder
rc = d/2;
m_c = rho*pi*rc^2*L;
ixx_c = m_c*(3*rc^2+L^2)/12;
iyy_c = m_c*(3*rc^2+L^2)/12;
izz_c = m_c*rc^2/2;

%% Sphere;
m_s = rho*4*pi*R^3/3;
ixx_s = m_s*2*R^2/5+m_s*L^2;
iyy_s = m_s*2*R^2/5+m_s*L^2;
izz_s = m_s*2*R^2/5;

Ixx = ixx_c + 2*ixx_s;
Iyy = iyy_c + 2*iyy_s;
Izz = izz_c + 2*izz_s;

I_mat = [Ixx 0 0; 0 Iyy 0; 0 0 Izz];
display(I_mat)

%% Q5

M01 = [1, 0, 0, 0; 0, 1, 0, 0; 0, 0, 1, 0.089159; 0, 0, 0, 1];
M12 = [0, 0, 1, 0.28; 0, 1, 0, 0.13585; -1, 0, 0, 0; 0, 0, 0, 1];
M23 = [1, 0, 0, 0; 0, 1, 0, -0.1197; 0, 0, 1, 0.395; 0, 0, 0, 1];
M34 = [0, 0, 1, 0; 0, 1, 0, 0; -1, 0, 0, 0.14225; 0, 0, 0, 1];
M45 = [1, 0, 0, 0; 0, 1, 0, 0.093; 0, 0, 1, 0; 0, 0, 0, 1];
M56 = [1, 0, 0, 0; 0, 1, 0, 0; 0, 0, 1, 0.09465; 0, 0, 0, 1];
M67 = [1, 0, 0, 0; 0, 0, 1, 0.0823; 0, -1, 0, 0; 0, 0, 0, 1];
G1 = diag([0.010267495893, 0.010267495893,  0.00666, 3.7, 3.7, 3.7]);
G2 = diag([0.22689067591, 0.22689067591, 0.0151074, 8.393, 8.393, 8.393]);
G3 = diag([0.049443313556, 0.049443313556, 0.004095, 2.275, 2.275, 2.275]);
G4 = diag([0.111172755531, 0.111172755531, 0.21942, 1.219, 1.219, 1.219]);
G5 = diag([0.111172755531, 0.111172755531, 0.21942, 1.219, 1.219, 1.219]);
G6 = diag([0.0171364731454, 0.0171364731454, 0.033822, 0.1879, 0.1879, 0.1879]);
Glist = cat(3, G1, G2, G3, G4, G5, G6);
Mlist = cat(3, M01, M12, M23, M34, M45, M56, M67); 
Slist = [0,         0,         0,         0,        0,        0;
         0,         1,         1,         1,        0,        1;
         1,         0,         0,         0,       -1,        0;
         0, -0.089159, -0.089159, -0.089159, -0.10915, 0.005491;
         0,         0,         0,         0,  0.81725,        0;
         0,         0,     0.425,   0.81725,        0,  0.81725];

theta_list = [0 pi/6 pi/4 pi/3 pi/2 2*pi/3]';
thetadot_list = [.2 .2 .2 .2 .2 .2]';
thetaddot_list = [.1 .1 .1 .1 .1 .1]';
g_vec = [0 0 -9.81]';
F_vec = [.1 .1 .1 .1 .1 .1]';

tau = InverseDynamics(theta_list, thetadot_list, thetaddot_list, g_vec, F_vec, Mlist, Glist, Slist);
display(tau)
